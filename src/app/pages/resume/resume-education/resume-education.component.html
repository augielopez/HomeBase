<div class="grid">
  <div class="col-12">
    <p-card header="Education" subheader="Manage your educational background">
      <ng-template pTemplate="content">
        <div *ngIf="loading" class="flex justify-content-center p-4">
          <p-progressSpinner></p-progressSpinner>
        </div>

        <div *ngIf="!loading">
          <div class="flex justify-content-between align-items-center mb-4">
            <h3 class="m-0">Education ({{ educations.length }})</h3>
            <p-button 
              label="Add New Education"
              icon="pi pi-plus"
              (click)="openNewEducationDialog()"
              severity="primary"
            ></p-button>
          </div>

          <div *ngIf="educations.length === 0" class="text-center p-4">
            <i class="pi pi-graduation-cap text-4xl text-blue-500 mb-3"></i>
            <p class="text-lg text-600">No education added yet</p>
            <p class="text-600">Click "Add New Education" to get started</p>
          </div>

          <div *ngIf="educations.length > 0" class="grid">
            <div *ngFor="let education of educations" class="col-12 md:col-6">
              <p-card class="education-card">
                <ng-template pTemplate="header">
                  <div class="flex justify-content-between align-items-center p-3">
                    <div>
                      <h4 class="m-0">{{ education.degree }}</h4>
                      <p class="m-0 text-600">{{ education.school }}</p>
                      <small class="text-500">{{ formatDateRange(education.start_date || '', education.end_date || '') }}</small>
                    </div>
                    <div class="flex gap-2">
                      <p-button 
                        icon="pi pi-pencil"
                        size="small"
                        severity="secondary"
                        (click)="openEditEducationDialog(education)"
                        [text]="true"
                      ></p-button>
                      <p-button 
                        icon="pi pi-trash"
                        size="small"
                        severity="danger"
                        (click)="confirmDelete(education)"
                        [text]="true"
                      ></p-button>
                    </div>
                  </div>
                </ng-template>
              </p-card>
            </div>
          </div>
        </div>
      </ng-template>
    </p-card>
  </div>
</div>

<!-- Education Dialog -->
<p-dialog 
  header="{{ editingEducation ? 'Edit Education' : 'Add New Education' }}"
  [(visible)]="showDialog"
  [modal]="true"
  [style]="{ width: '500px' }"
  [closable]="!saving"
>
  <form (ngSubmit)="saveEducation()" #eduForm="ngForm">
    <div class="field">
      <label for="degree" class="font-medium">Degree *</label>
      <input 
        pInputText 
        id="degree"
        name="degree"
        [(ngModel)]="educationForm.degree"
        #degreeField="ngModel"
        required
        class="w-full"
        placeholder="Enter degree (e.g., Bachelor of Science in Computer Science)"
        [disabled]="saving"
      />
      <small *ngIf="degreeField.invalid && degreeField.touched" class="p-error">
        Degree is required
      </small>
    </div>

    <div class="field">
      <label for="school" class="font-medium">School/University *</label>
      <input 
        pInputText 
        id="school"
        name="school"
        [(ngModel)]="educationForm.school"
        #schoolField="ngModel"
        required
        class="w-full"
        placeholder="Enter school or university name"
        [disabled]="saving"
      />
      <small *ngIf="schoolField.invalid && schoolField.touched" class="p-error">
        School is required
      </small>
    </div>

    <div class="grid">
      <div class="col-6">
        <div class="field">
          <label for="startDate" class="font-medium">Start Year</label>
          <input 
            pInputText 
            type="date"
            id="startDate"
            name="startDate"
            [(ngModel)]="educationForm.start_date"
            class="w-full"
            [disabled]="saving"
          />
        </div>
      </div>
      <div class="col-6">
        <div class="field">
          <label for="endDate" class="font-medium">End Year</label>
          <input 
            pInputText 
            type="date"
            id="endDate"
            name="endDate"
            [(ngModel)]="educationForm.end_date"
            class="w-full"
            [disabled]="saving"
          />
        </div>
      </div>
    </div>
  </form>

  <ng-template pTemplate="footer">
    <div class="flex justify-content-end gap-2">
      <p-button 
        label="Cancel"
        icon="pi pi-times"
        (click)="cancelEdit()"
        [disabled]="saving"
        severity="secondary"
        [text]="true"
      ></p-button>
      <p-button 
        label="{{ editingEducation ? 'Update' : 'Add' }}"
        icon="pi pi-check"
        (click)="saveEducation()"
        [disabled]="!educationForm.degree?.trim() || !educationForm.school?.trim() || saving"
        [loading]="saving"
        severity="primary"
      ></p-button>
    </div>
  </ng-template>
</p-dialog>

<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>
