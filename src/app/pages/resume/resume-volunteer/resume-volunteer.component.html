<div class="grid">
  <div class="col-12">
    <p-card header="Volunteer Work" subheader="Manage your volunteer experience and community involvement">
      <ng-template pTemplate="content">
        <div *ngIf="loading" class="flex justify-content-center p-4">
          <p-progressSpinner></p-progressSpinner>
        </div>

        <div *ngIf="!loading">
          <div class="flex justify-content-between align-items-center mb-4 gap-3">
            <h3 class="m-0">Volunteer Work ({{ volunteerWork.length }})</h3>
            <p-button 
              label="Add New Volunteer Work"
              icon="pi pi-plus"
              (click)="openNewVolunteerDialog()"
              severity="primary"
            ></p-button>
          </div>

          <div *ngIf="volunteerWork.length === 0" class="text-center p-4">
            <i class="pi pi-heart text-4xl text-blue-500 mb-3"></i>
            <p class="text-lg text-600">No volunteer work added yet</p>
            <p class="text-600">Click "Add New Volunteer Work" to get started</p>
          </div>

          <div *ngIf="volunteerWork.length > 0" class="grid">
            <div *ngFor="let volunteer of volunteerWork" class="col-12 md:col-6">
              <p-card class="volunteer-card">
                <ng-template pTemplate="header">
                  <div class="flex justify-content-between align-items-center p-3">
                    <h4 class="m-0">{{ volunteer.role }}</h4>
                    <div class="flex gap-2">
                      <p-button 
                        icon="pi pi-pencil"
                        size="small"
                        severity="secondary"
                        (click)="openEditVolunteerDialog(volunteer)"
                        [text]="true"
                      ></p-button>
                      <p-button 
                        icon="pi pi-trash"
                        size="small"
                        severity="danger"
                        (click)="confirmDelete(volunteer)"
                        [text]="true"
                      ></p-button>
                    </div>
                  </div>
                </ng-template>
                <ng-template pTemplate="content">
                  <p *ngIf="volunteer.description" class="mb-3">{{ volunteer.description }}</p>
                  <div *ngIf="volunteer.tags && volunteer.tags.length > 0">
                    <p-chips 
                      [ngModel]="volunteer.tags" 
                      [disabled]="true"
                      class="w-full"
                    ></p-chips>
                  </div>
                  <div *ngIf="!volunteer.tags || volunteer.tags.length === 0" class="text-600">
                    No tags added
                  </div>
                </ng-template>
              </p-card>
            </div>
          </div>
        </div>
      </ng-template>
    </p-card>
  </div>
</div>

<!-- Volunteer Dialog -->
<p-dialog 
  header="{{ editingVolunteer ? 'Edit Volunteer Work' : 'Add New Volunteer Work' }}"
  [(visible)]="showDialog"
  [modal]="true"
  [style]="{ width: '600px' }"
  [closable]="!saving"
>
  <form (ngSubmit)="saveVolunteer()" #volForm="ngForm">
    <div class="field">
      <label for="role" class="font-medium">Role/Position *</label>
      <input 
        pInputText 
        id="role"
        name="role"
        [(ngModel)]="volunteerForm.role"
        #roleField="ngModel"
        required
        class="w-full"
        placeholder="Enter your volunteer role or position"
        [disabled]="saving"
      />
      <small *ngIf="roleField.invalid && roleField.touched" class="p-error">
        Role is required
      </small>
    </div>

    <div class="field">
      <label for="description" class="font-medium">Description</label>
      <textarea 
        pInputTextarea 
        id="description"
        name="description"
        [(ngModel)]="volunteerForm.description"
        rows="4"
        class="w-full"
        placeholder="Describe your volunteer work, organization, and impact"
        [disabled]="saving"
      ></textarea>
    </div>

    <div class="field">
      <label for="tags" class="font-medium">Tags</label>
      <p-chips 
        id="tags"
        [(ngModel)]="volunteerForm.tags"
        placeholder="Add tags (press Enter)"
        class="w-full"
        [disabled]="saving"
      ></p-chips>
      <small class="text-600">Add relevant tags (e.g., Community Service, Leadership, Fundraising)</small>
    </div>
  </form>

  <ng-template pTemplate="footer">
    <div class="flex justify-content-end gap-2">
      <p-button 
        label="Cancel"
        icon="pi pi-times"
        (click)="cancelEdit()"
        [disabled]="saving"
        severity="secondary"
        [text]="true"
      ></p-button>
      <p-button 
        label="{{ editingVolunteer ? 'Update' : 'Add' }}"
        icon="pi pi-check"
        (click)="saveVolunteer()"
        [disabled]="!volunteerForm.role?.trim() || saving"
        [loading]="saving"
        severity="primary"
      ></p-button>
    </div>
  </ng-template>
</p-dialog>

<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>
